# assets 폴더 위치에 따른 퍼포먼스

**목차**

- [assets 폴더 위치에 따른 퍼포먼스](#assets-폴더-위치에-따른-퍼포먼스)
  - [1. React Native에서 정적 이미지를 찾는 방식](#1-react-native에서-정적-이미지를-찾는-방식)
    - [프로젝트 폴더 내에 존재하는 경우](#프로젝트-폴더-내에-존재하는-경우)
  - [2. 이미지 저장 공간과 장단점](#2-이미지-저장-공간과-장단점)
    - [프로젝트 내부](#프로젝트-내부)
    - [Native App 내부](#native-app-내부)
    - [외부 저장소 (ex. AWS S3, imgix 등)](#외부-저장소-ex-aws-s3-imgix-등)
  - [레퍼런스](#레퍼런스)

## 1. React Native에서 정적 이미지를 찾는 방식

### 프로젝트 폴더 내에 존재하는 경우

이미지 파일이 **Native** 쪽이 아닌 **React Native** 프로젝트 폴더 내에 존재하는 경우 **Bundler**가 **JavaScript** 파일을 찾는 방식과 동일하게 이미지 파일을 찾습니다.

예를 들어 다음과 같은 코드가 있다고 가정합니다.

```jsx
// CommonJS
<Image source={require('./my-icon.png')} />;

// ESModule
import myIcon from './my-icon.png';

<Image source={myIcon} />;
```

위와 같이 작성했을 경우 현재 폴더 내에 존재하는 `my-icon.png`라는 파일을 번들러가 찾습니다.

**JavaScript** 파일과 읽는 방식이 동일하기 때문에 **프로젝트 root에 assets 폴더를 두는 것**과 **src 폴더 하위에 assets 폴더를 두는 것**의 퍼포먼스 차이는 사용자가 느낄 정도는 아니라고 생각합니다.

결국 UI를 그리는 주체는 브릿지 너머에 있는 **Native** 코드이기 때문에 프로젝트 폴더 내에 이미지가 존재하는 이상 이미지의 저장 위치로 인한 시간 소요보다 이미지 데이터가 브릿지를 넘어가는 과정에서의 시간 소요가 발생한다고 볼 수 있습니다.

그러면 "이미지 데이터가 브릿지를 넘어가는 과정에서의 시간 소요를 줄일 순 없는건가?" 라는 생각이 듭니다. 이에 관해서는 이미지 저장 공간과 장단점에 대해서 설명하면서 같이 설명하겠습니다.

## 2. 이미지 저장 공간과 장단점

**React Native**로 만들어진 프로젝트에서 이미지 저장하는 방법은 크게 3가지입니다.

- 프로젝트 내부
- Native App 내부
- 외부 저장소 (ex. AWS S3 등)

### 프로젝트 내부

**장점**

- OS에 상관없이 동일한 위치에 이미지 파일을 저장할 수 있습니다.
- 앱을 패키징했을 경우 이미지를 사용하는 경우에만 이미지가 포함됩니다.
- 앱을 추가하고 수정한 경우 다시 빌드하지 않아도 됩니다. 그저 시뮬레이터(또는 에뮬레이터)를 새로고침하면 됩니다.
- 번들러가 스크린 사이즈와 제일 근접한 이미지를 알아서 가져와 줍니다. (1배수, 2배수, 3배수 이미지가 존재할 경우)

**단점**

- 앱의 패키징 사이즈(사용자가 스토어에서 받는 앱의 용량)가 증가합니다.

### Native App 내부

이 부분이 위에서 언급한 이미지 데이터가 브릿지를 넘어가는 과정에서의 시간 소요를 줄일 수 있는 방법입니다. 프로젝트 내부에 이미지 파일이 존재하는 이상 이미지 데이터가 브릿지를 넘어 네이티브 쪽으로 이동하는 시간이 발생합니다. 이미지 파일 자체가 아예 Native 폴더 내에 존재한다면 브릿지를 넘어가지 않아도 이미지 파일에 접근할 수 있기 때문에 앞서 말한 시간 소요를 줄일 수 있습니다.

다만, 이미지를 사용하지 않더라도 이미지 파일이 패키징되며 OS에 따라 다른 폴더 위치에 이미지를 저장해줘야 합니다.

**장점**

- 이미지 데이터가 브릿지를 넘어가는 시간을 줄일 수 있습니다.

**단점**

- 앱의 패키징 사이즈(사용자가 스토어에서 받는 앱의 용량)가 증가합니다. 이미지를 사용하지 않는 경우에도 패키징 사이즈에 이미지 용량이 포함됩니다.
- OS에 따라 다른 폴더 위치에 이미지를 저장해줘야 합니다.

이 방법은 장점보다 단점이 더 크다고 생각합니다. 한꺼번에 상당히 많은 양의 이미지 리소스를 불러오는 경우가 아니라면 이미지 데이터가 브릿지를 넘어가는 시간을 줄이는 것이 유의미한 변화를 가져다 줄 것이라 생각이 들진 않습니다. (이 정도 차이는 사용자 핸드폰 성능으로 커버할 수 있다고 생각합니다)

### 외부 저장소 (ex. AWS S3, imgix 등)

**AWS S3**와 같은 클라우드 저장소를 이용하는 방법입니다. 장점이라고 한다면 앱 내에 존재하는 이미지 파일이 외부 저장소로 이동하면서 앱의 패키징 사이즈가 줄어든다는 점입니다.

단점은 외부 저장소에서 이미지를 네트워크 요청으로 가져올 경우 브라우저와 달리 **React Native**에서는 가져온 이미지의 사이즈대로 화면에 렌더링하지 않는다는 것입니다.

프로젝트 내부나 **Native** 폴더 내에 있는 이미지 파일을 렌더링할 때와는 달리 가져온 이미지 사이즈를 반영하지 않기 때문에 style 속성 값으로 무조건 이미지 사이즈를 명시해줘야 합니다.

**장점**

- 앱의 패키징 사이즈 감소

**단점**

- `style` 속성값으로 이미지 사이즈 명시 필수
- 이미지를 가져오기 위한 네트워크 요청 발생

아이콘 이미지와 같은 작은 사이즈의 이미지가 아닌 큰 사이즈의 이미지일 경우 앱의 용량을 줄이기 위해서라도 **S3**와 같은 저장소를 이용하는 것이 좋다고 봅니다.

## 레퍼런스

- [Images · React Native](https://reactnative.dev/docs/images)
- [React Native Image Performance](https://medium.com/@adamjacobb/react-native-performance-images-adf5843e120)
- [ImageOptim - better Save for Web](https://imageoptim.com/mac)
- [Fetching Responsive Images in React Native to Boost Performance](https://medium.com/finimize-engineering/fetching-responsive-images-in-react-native-to-boost-performance-cd638cd0928e)
